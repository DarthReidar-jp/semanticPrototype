doctype html
html
  head
    title= title
    link(rel='stylesheet', href='/stylesheets/style.css')
    link(rel='stylesheet', href='/stylesheets/display.css')
    link(rel='stylesheet', href='/stylesheets/treeDisplay.css')
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous")
      //mixinの定義
      //ツリー上にメモを表示するmixin
      mixin displayMemo(memo, level = 0)
        - var indent = 200; // 各階層でのインデントの量
        .memo-container(style=`margin-left: ${level * indent}px;`)
          .memo-card(class=`level-${level}` data-memo-id=memo.node._id)
            .card.h-100
            .card-body
              h5.card-title= memo.node.title
              p.card-text= memo.node.content
              if memo.node.score
                p.card-text Score: #{memo.node.score.toFixed(5)}
              a.stretched-link(href=`/detail/${memo.node._id}`) 

        if memo.children && memo.children.length
          each child in memo.children
            +displayMemo(child, level + 1) // 子ノードを再帰的に表示
  body
    header
      .container.row
        form.col-8.search-form(method="GET", action="/treeSearch")
          .input-group
            input.form-control(type="text", name="query", placeholder="Search memos...")
            .input-group-append
              button.btn.btn-primary(type="submit") ツリーサーチ       
    .container-fluid
      .row
        // サイドバー
        .col-md-2.sidebar
          .sidebar-content
        // メインコンテンツ
        .col-md-10.main-content
          .row
            if memos
              +displayMemo(memos, 0)
            else
              .col-12
                p No memos found.
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous")
    script(src="/javascripts/display.js")
